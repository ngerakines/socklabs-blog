<!DOCTYPE html>
<html>
  <head>
	<link href="/css/style.css" media="screen" rel="stylesheet" type="text/css" />
    <title>Nick's Blog | Email feeds with procmail
</title>
  </head>
  <body>
	<a href="/"><h1>Nick's Blog</h1></a>
	<div id="content">
		<div id="posts">
			<h2><a alt="Email feeds with procmail
" href="/2006/03/07/email_feeds_with_procmail.html">Email feeds with procmail
</a></h2>
			<em id="sub_h2">07 March 2006</em>
		 	<p>With a little bit of hacking you can easily setup procmail to create a rss or atom feeds to let you know about new messages. I'm going to try to keep this simple. Setting this up assumes that you have a working procmail installation going for you.</p>

<p>First, download and take a look at the following scripts: <a href="http://blog.socklabs.com/wp-content/mail2rss.txt">mail2rss.pl</a> and <a href="http://blog.socklabs.com/wp-content/proclog.txt">proclog.pl</a>.</p>

<p>mail2rss.pl simply takes a subject and from string via getopts and writes it to a file in the form of an rss feed. You could easily extend it with extra information and headers and such, but for the sake of this example I'm keeping it simple. You'll want to edit the output file that it writes to. I write to a file called mail-rss.xml which lives in my home directory, netnewswire reads local feeds just fine and that works for me. You'll also want to adjust the cleanup period, in the example it is set to 6 hours, to make it longer or shorter depending on how much mail you normally get.</p>

<p>proclog.pl takes the output of mailstat and pipes it to the feed as well. This script you'll need to put on a cron to run every hour or so to get the best use out of it. It is more for information purposes than anything else.</p>

<p>Now take a look at the following procmail config file: <a href="http://blog.socklabs.com/wp-content/procmailrc">procmailrc</a>. Specifically, note it sucks the subject and from headers and puts them into variables that are then passed to the mail2rss.pl script. It also forces a lockfile to be used when writing to the mail feed for data sanity.</p>

<p>With this configuration, every time procmail runs (which is when new mail arrives) it updates the mail feed. There are some caveats, like broken encoding and such in subject lines, but overall it works really well. In combination with the proclog.pl script running every hour, I can get a nice feel for what mail I got and where it went.</p>

<p>Every so often I get a warning that pops up in my procmail log that looks like this: <code>procmail: Error while writing to "/Users/ngerakines/bin/mail2rss.pl"</code>. If anyone knows why, drop me a line. I'm still very new to procmail configuration.</p>

		</div>
		<div id="sidebar">
	<div class="clear"></div>
	<div id="sidebar_content">
		<h2>Recently</h2>
		
			<h3 style="padding-top: 10px;"><a alt="Integrating Heman into CalendERL About Nothing" href="/2009/12/28/integrating_heman_into_calenderl_about_nothing.html">Integrating Heman into CalendERL About Nothing</a></h3>
			<em id="sub_h3">28 December 2009</em>
		
			<h3 style="padding-top: 10px;"><a alt="Lets create some Erlang standards, part one" href="/2009/11/24/lets_create_some_erlang_standards_part_one.html">Lets create some Erlang standards, part one</a></h3>
			<em id="sub_h3">24 November 2009</em>
		
			<h3 style="padding-top: 10px;"><a alt="2009 Erlang User Conference" href="/2009/11/12/EUC2009.html">2009 Erlang User Conference</a></h3>
			<em id="sub_h3">12 November 2009</em>
		
			<h3 style="padding-top: 10px;"><a alt="CalendERL About Nothing" href="/2009/11/01/calenderl_about_nothing.html">CalendERL About Nothing</a></h3>
			<em id="sub_h3">01 November 2009</em>
		
			<h3 style="padding-top: 10px;"><a alt="Globally Shared Queues" href="/2009/10/26/globally_shared_queues.html">Globally Shared Queues</a></h3>
			<em id="sub_h3">26 October 2009</em>
		
		<h2 style="padding-top: 20px;"><a href="/about/">About</a></h2>
		<h2 style="padding-top: 20px;"><a href="/projects/">Projects</a></h2>
		<h2 style="padding-top: 20px;"><a href="/archives/">Archives</a></h2>
	</div>
</div>

		<div id="disqus_thread"></div>
	</div>
	<script type="text/javascript" src="http://disqus.com/forums/socklabs-blog/embed.js"></script>
<noscript>
	<a href="http://disqus.com/forums/socklabs-blog/?url=ref">View the discussion thread.</a>
</noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
<script type="text/javascript">
//<![CDATA[
(function() {
	var links = document.getElementsByTagName('a');
	var query = '?';
	for(var i = 0; i < links.length; i++) {
	if(links[i].href.indexOf('#disqus_thread') >= 0) {
		query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
	}
	}
	document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/socklabs-blog/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script>

	<div class="clear"></div>
	<div id="footer">
	<a href="/" alt="blog"><b>Blog</b></a>
	| <a href="http://socklabs.com">Socklabs</a>
	| <a href="http://twitter.com/ngerakines" alt="status">On Twitter</a>
	| <a alt="ngerakines on Facebook" href="http://facebook.com/ngerakines">on Facebook</a>
</div>
	</body>
</html>